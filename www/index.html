---
date: Last Modified
layout: layout
---

      <div class="jumbotron">
        <h1>Content Security Policy Reference</h1>
        <p class="lead">The <em>new</em> <code>Content-Security-Policy</code> HTTP response header helps you reduce XSS risks on modern browsers by declaring, which dynamic resources are allowed to load.</p>
      </div>

      <a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Fcontent-security-policy.com%2F" rel="nofollow" class="btn btn-primary"><i class="fa fa-twitter"></i> Tweet</a>
      <a href="https://github.com/foundeo/content-security-policy.com/" class="btn btn-default"><i class="fa fa-github"></i> Edit on GitHub</a>
      <hr>

      <h2>What is Content-Security-Policy?</h2>
      <p><dfn>Content-Security-Policy</dfn> is the name of a HTTP response header that modern browsers use to enhance the security of the document (or web page). The Content-Security-Policy header allows you to restrict how resources such as JavaScript, CSS, or pretty much anything that the browser loads.</p>
      <p>Although it is primarily used as a HTTP response header, you can also apply it via a <a href="/examples/meta/">meta tag</a>.</p>
      <p>The term Content Security Policy is often abbreviated as <abbr title="Content Security Policy">CSP</abbr>.</p>
      <h2>What types of attacks does Content-Security-Policy help mitigate?</h2>
      <p >CSP was first designed to reduce the attack surface of Cross Site Scripting (XSS) attacks, later versions of the spec also protect against other forms of attack such as Click Jacking.</p>


      <div class="marketing">
        <h2>CSP Browser Support</h2>
        <div>Content Security Policy is supported by all the major modern browsers, and has been for many years. It is not supported in Internet Explorer.</div>

        <h3><i class="fa fa-chrome"></i> Chrome</h3>
        <div class="pd">
          <code>Content-Security-Policy</code> <span class="label label-success">CSP Level 3</span> - Chrome 59+ <small>Partial Support</small><br>
          <code>Content-Security-Policy</code> <span class="label label-success">CSP Level 2</span> - Chrome 40+ <small>Full Support Since January 2015</small><br>
          <code>Content-Security-Policy</code> <span class="label label-success">CSP 1.0</span> - Chrome 25+<br>
          <code>X-Webkit-CSP</code> <span class="label label-warning">Deprecated</span> - Chrome 14-24
        </div>

        <h3><i class="fa fa-firefox"></i> FireFox</h3>
        <div class="pd">
          <code>Content-Security-Policy</code> <span class="label label-success">CSP Level 3</span> - Firefox 58+ <small>Partial Support</small><br>
          <code>Content-Security-Policy</code> <span class="label label-success">CSP Level 2</span> - FireFox 31+ <small title="45+ is missing the plugin-types directive"><em>Partial Support</em> since July 2014</small><br>
          <code>Content-Security-Policy</code> <span class="label label-success">CSP 1.0</span> - FireFox 23+ <small>Full Support</small><br>
          <code>X-Content-Security-Policy</code> <span class="label label-warning">Deprecated</span> - FireFox 4-22
        </div>

        <h3><i class="fa fa-safari"></i> Safari</h3>
        <div class="pd">
          <code>Content-Security-Policy</code> <span class="label label-success">CSP Level 2</span> - Safari 10+<br>
          <code>Content-Security-Policy</code> <span class="label label-success">CSP 1.0</span> - Safari 7+<br>
          <code>X-Webkit-CSP</code> <span class="label label-warning">Deprecated</span> - Safari 6
        </div>

        <h3><i class="fa fa-edge"></i> Edge</h3>
        <div class="pd">
          <code>Content-Security-Policy</code> <span class="label label-success">CSP Level 3</span> - Edge 79+ <small>Partial Support</small><br>
          <code>Content-Security-Policy</code> <span class="label label-success">CSP Level 2</span> - Edge 15+ Partial, 76+ Full<br>
          <code>Content-Security-Policy</code> <span class="label label-success">CSP 1.0</span> - Edge 12+<br>
        </div>

        <h3><i class="fa fa-internet-explorer"></i> Internet Explorer</h3>
        <div class="pd">
          <code>X-Content-Security-Policy</code> <span class="label label-warning">Deprecated</span> - IE 10-11 support <code>sandbox</code> only
        </div>

        <br>

        
        <p>Try our <a href="browser-test/">CSP Browser Test</a> to test your browser.</p>
        <p>Note: It is known that having both <code>Content-Security-Policy</code> and <code>X-Content-Security-Policy</code> or <code>X-Webkit-CSP</code> causes unexpected behaviours on certain versions of browsers. Please avoid using deprecated <code>X-*</code> headers.</p>
      </div>


      
      <h2 id="directive">CSP Directive Reference</h2>
      <p>The <code>Content-Security-Policy</code> header value is made up of one or more directives (defined below), multiple directives are separated with a semicolon <code>;</code></p>
      <p>This documentation is provided based on the Content Security Policy Level 2 <a href="https://www.w3.org/TR/CSP2/">W3C Recommendation</a>, and the CSP Level 3 <a href="https://www.w3.org/TR/CSP3/">W3C Working Draft</a></p>

      <h3><a href="/default-src/"><code>default-src</code></a></h3>
      <div class="pd">
        <p>The <code>default-src</code> directive defines the default policy for fetching resources such as JavaScript, Images, CSS, Fonts, AJAX requests, Frames, HTML5 Media. Not all directives fallback to <code>default-src</code>. See the <a href="#source_list">Source List Reference</a> for possible values.</p>
        <h5>Example default-src Policy</h5>
        <pre>default-src 'self' cdn.example.com;</pre>
        <span class="label label-success">CSP Level 1</span>
        <span class="label label-default" title="Chrome 25+ - February 2013"><i class="fa fa-chrome"></i> 25+</span>
        <span class="label label-default" title="Firefox 23+ - August 2013"><i class="fa fa-firefox"></i> 23+</span>
        <span class="label label-default" title="Safari 7+ - October 2013"><i class="fa fa-safari"></i> 7+</span>
        <span class="label label-default" title="IE Edge 12.10240+ - July 2015"><i class="fa fa-edge"></i> 12+</span>
      </div>

      <h3><a href="/script-src/"><code>script-src</code></a></h3>
      <div class="pd">
        <p>Defines valid sources of JavaScript.</p>
        <h5>Example script-src Policy</h5>
        <pre>script-src 'self' js.example.com;</pre>
        <span class="label label-success">CSP Level 1</span>
        <span class="label label-default" title="Chrome 25+ - February 2013"><i class="fa fa-chrome"></i> 25+</span>
        <span class="label label-default" title="Firefox 23+ - August 2013"><i class="fa fa-firefox"></i> 23+</span>
        <span class="label label-default" title="Safari 7+ - October 2013"><i class="fa fa-safari"></i> 7+</span>
        <span class="label label-default" title="IE Edge 12.10240+ - July 2015"><i class="fa fa-edge"></i> 12+</span>
      </div>

      <h3><a href="/style-src/" title="CSP style-src Guide"><code>style-src</code></a></h3>
      <div class="pd">
        <p>Defines valid sources of stylesheets or CSS.</p>

        <h5>Example style-src Policy</h5>
        <pre>style-src 'self' css.example.com;</pre>
        <span class="label label-success">CSP Level 1</span>
        <span class="label label-default" title="Chrome 25+ - February 2013"><i class="fa fa-chrome"></i> 25+</span>
        <span class="label label-default" title="Firefox 23+ - August 2013"><i class="fa fa-firefox"></i> 23+</span>
        <span class="label label-default" title="Safari"><i class="fa fa-safari"></i> 7+</span>
        <span class="label label-default" title="IE Edge 12.10240+ - July 2015"><i class="fa fa-edge"></i> 12+</span>
      </div>

      <h3><a href="/img-src/" title="CSP img-src docs"><code>img-src</code></a></h3>
      <div class="pd">
        <p>Defines valid sources of images.</p>
        <h5>Example img-src Policy</h5>
        <pre>img-src 'self' img.example.com;</pre>
        <span class="label label-success">CSP Level 1</span>
        <span class="label label-default" title="Chrome 25+ - February 2013"><i class="fa fa-chrome"></i> 25+</span>
        <span class="label label-default" title="Firefox 23+ - August 2013"><i class="fa fa-firefox"></i> 23+</span>
        <span class="label label-default" title="Safari 7+ - October 2013"><i class="fa fa-safari"></i> 7+</span>
        <span class="label label-default" title="IE Edge 12.10240+ - July 2015"><i class="fa fa-edge"></i> 12+</span>
      </div>

      <h3><a href="/connect-src/" title="CSP connect-src Directive"><code>connect-src</code></a></h3>
      <div class="pd">
        <p>Applies to <code>XMLHttpRequest</code> (AJAX), <code>WebSocket</code>, <code>fetch()</code>, <code>&lt;a ping&gt;</code> or <code>EventSource</code>. If not allowed the browser emulates a <code>400</code> HTTP status code.</p>
        <h5>Example connect-src Policy</h5>
        <pre>connect-src 'self';</pre>
        <span class="label label-success">CSP Level 1</span>
        <span class="label label-default" title="Chrome 25+ - February 2013"><i class="fa fa-chrome"></i> 25+</span>
        <span class="label label-default" title="Firefox 23+ - August 2013"><i class="fa fa-firefox"></i> 23+</span>
        <span class="label label-default" title="Safari 7+ - October 2013"><i class="fa fa-safari"></i> 7+</span>
        <span class="label label-default" title="IE Edge 12.10240+ - July 2015"><i class="fa fa-edge"></i> 12+</span>
      </div>

      <h3><a href="/font-src/"><code>font-src</code></a></h3>
      <div class="pd">
        <p>Defines valid sources of font resources (loaded via <code>@font-face</code>).</p>
        <h5>Example font-src policy</h5>
        <pre>font-src font.example.com;</pre>
        <span class="label label-success">CSP Level 1</span>
        <span class="label label-default" title="Chrome 25+ - February 2013"><i class="fa fa-chrome"></i> 25+</span>
        <span class="label label-default" title="Firefox 23+ - August 2013"><i class="fa fa-firefox"></i> 23+</span>
        <span class="label label-default" title="Safari 7+ - October 2013"><i class="fa fa-safari"></i> 7+</span>
        <span class="label label-default" title="IE Edge 12.10240+ - July 2015"><i class="fa fa-edge"></i> 12+</span>
      </div>

      <h3><code>object-src</code></h3>
      <div class="pd">
        <p>Defines valid sources of plugins, eg <code>&lt;object&gt;</code>, <code>&lt;embed&gt;</code> or <code>&lt;applet&gt;</code>.</p>
        <h5>Example object-src Policy</h5>
        <pre>object-src 'self';</pre>
        <span class="label label-success">CSP Level 1</span>
        <span class="label label-default" title="Chrome 25+ - February 2013"><i class="fa fa-chrome"></i> 25+</span>
        <span class="label label-default" title="Firefox 23+ - August 2013"><i class="fa fa-firefox"></i> 23+</span>
        <span class="label label-default" title="Safari 7+ - October 2013"><i class="fa fa-safari"></i> 7+</span>
        <span class="label label-default" title="IE Edge 12.10240+ - July 2015"><i class="fa fa-edge"></i> 12+</span>
      </div>

      <h3><code>media-src</code></h3>
      <div class="pd">
        <p>Defines valid sources of audio and video, eg HTML5 <code>&lt;audio&gt;</code>, <code>&lt;video&gt;</code> elements.</p>
        <h5>Example media-src Policy</h5>
        <pre>media-src media.example.com;</pre>
        <span class="label label-success">CSP Level 1</span>
        <span class="label label-default" title="Chrome 25+ - February 2013"><i class="fa fa-chrome"></i> 25+</span>
        <span class="label label-default" title="Firefox 23+ - August 2013"><i class="fa fa-firefox"></i> 23+</span>
        <span class="label label-default" title="Safari 7+ - October 2013"><i class="fa fa-safari"></i> 7+</span>
        <span class="label label-default" title="IE Edge 12.10240+ - July 2015"><i class="fa fa-edge"></i> 12+</span>
      </div> 

      <h3><code>frame-src</code></h3>
      <div class="pd">
        <p>Defines valid sources for loading frames. In CSP Level 2 <code>frame-src</code> was deprecated in favor of the <code>child-src</code> directive. CSP Level 3, has <em>undeprecated</em> <code>frame-src</code> and it will continue to defer to <code>child-src</code> if not present.</p>
        <h5>Exapmle frame-src Policy</h5>
        <pre>frame-src 'self';</pre>
        <span class="label label-success">CSP Level 1</span>
      </div>

      <h3><code>sandbox</code></h3>
      <div class="pd">
        <p>Enables a sandbox for the requested resource similar to the <code>iframe</code> <code>sandbox</code> attribute. The sandbox applies a same origin policy, prevents popups, plugins and script execution is blocked.
            You can keep the sandbox value empty to keep all restrictions in place, or add values: <code>allow-forms</code> <code>allow-same-origin</code> <code>allow-scripts</code> <code>allow-popups</code>, <code>allow-modals</code>, <code>allow-orientation-lock</code>, <code>allow-pointer-lock</code>, <code>allow-presentation</code>, <code>allow-popups-to-escape-sandbox</code>, and <code>allow-top-navigation</code></p>
        <h5>Example sandbox Policy</h5>
        <pre>sandbox allow-forms allow-scripts;</pre>
        <span class="label label-success">CSP Level 1</span>
        <span class="label label-default" title="Chrome 25+ - February 2013"><i class="fa fa-chrome"></i> 25+</span>
        <span class="label label-default" title="Firefox 50+"><i class="fa fa-firefox"></i> 50+</span>
        <span class="label label-default" title="Safari 7+ - October 2013"><i class="fa fa-safari"></i> 7+</span>
        <span class="label label-default" title="IE Edge 12.10240+ - July 2015"><i class="fa fa-edge"></i> 12+</span>
      </div>

      <h3><code>report-uri</code></h3>
      <div class="pd">
        <p>Instructs the browser to POST a reports of policy failures to this URI. You can also use <code>Content-Security-Policy-Report-Only</code> as the HTTP header name to instruct the browser to only send reports (does not block anything). This directive is deprecated in CSP Level 3 in favor of the <code>report-to</code> directive.</p>
        <h5>Example report-uri</h5>
        <pre>report-uri /some-report-uri;</pre>
        <span class="label label-success">CSP Level 1</span>
        <span class="label label-default" title="Chrome 25+ - February 2013"><i class="fa fa-chrome"></i> 25+</span>
        <span class="label label-default" title="Firefox 23+ - August 2013"><i class="fa fa-firefox"></i> 23+</span>
        <span class="label label-default" title="Safari 7+ - October 2013"><i class="fa fa-safari"></i> 7+</span>
        <span class="label label-default" title="IE Edge 12.10240+ - July 2015"><i class="fa fa-edge"></i> 12+</span>
      </div>

      <h3><code>child-src</code></h3>
      <div class="pd">
        <p>Defines valid sources for web workers and nested browsing contexts loaded using elements such as <code>&lt;frame&gt;</code> and <code>&lt;iframe&gt;</code></p>
        <h5>Example child-src Policy</h5>
        <pre>child-src 'self'</pre>
        <span class="label label-success">CSP Level 2</span>
        <span class="label label-default" title="Chrome 40+ - January 2015"><i class="fa fa-chrome"></i> 40+</span>
        <span class="label label-default" title="Firefox 45+ - March 2016"><i class="fa fa-firefox"></i> 45+</span>
        <span class="label label-default" title="Edge 15+ - January 2017"><i class="fa fa-edge"></i> 15+</span>
      </div>

      <h3><code>form-action</code></h3>
      <div class="pd">
        <p>Defines valid sources that can be used as an HTML <code>&lt;form&gt;</code> action.</p>
        <h5>Example form-action Policy</h5>
        <pre>form-action 'self';</pre>
        <span class="label label-success">CSP Level 2</span>
        <span class="label label-default" title="Chrome 40+ - January 2015"><i class="fa fa-chrome"></i> 40+</span>
        <span class="label label-default" title="Firefox 36+ - February 2015 "><i class="fa fa-firefox"></i> 36+</span>
        <span class="label label-default" title="Edge 15+ - January 2017"><i class="fa fa-edge"></i> 15+</span>
      </div>

      <h3><a href="/frame-ancestors/"><code>frame-ancestors</code></a></h3>
      <div class="pd">
        <p>Defines valid sources for embedding the resource using <code>&lt;frame&gt;</code> <code>&lt;iframe&gt;</code> <code>&lt;object&gt;</code> <code>&lt;embed&gt;</code> <code>&lt;applet&gt;</code>. Setting this directive to <code>'none'</code> should be roughly equivalent to <code>X-Frame-Options: DENY</code></p>
        <h5>Example frame-ancestors Policy</h5>
        <pre>frame-ancestors 'none';</pre>
        <span class="label label-success">CSP Level 2</span>
        <span class="label label-default" title="Chrome 39+ - November 2014"><i class="fa fa-chrome"></i> 39+</span>
        <span class="label label-default" title="Firefox 33+ - October 2014"><i class="fa fa-firefox"></i> 33+</span>
        <span class="label label-default" title="Edge 15+ - January 2017"><i class="fa fa-edge"></i> 15+</span>
      </div>  

      <h3><code>plugin-types</code></h3>
      <div class="pd">
        <p>Defines valid MIME types for plugins invoked via  <code>&lt;object&gt;</code> and <code>&lt;embed&gt;</code>. To load an <code>&lt;applet&gt;</code> you must specify <code>application/x-java-applet</code>.</p>
        <h5>Example plugin-types Policy</h5>
        <pre>plugin-types application/pdf;</pre>
        <span class="label label-success">CSP Level 2</span>
        <span class="label label-default" title="Chrome 40+ - January 2015"><i class="fa fa-chrome"></i> 40+</span>
        <span class="label label-default" title="Edge 15+ - January 2017"><i class="fa fa-edge"></i> 15+</span>
      </div>
      <h3><code>base-uri</code></h3>
      <div class="pd">
        <p>Defines a set of allowed URLs which can be used in the <code>src</code> attribute of a HTML <code>base</code> tag.</p>
        <h5>Example base-uri Policy</h5>
        <pre>base-uri 'self';</pre>
        <span class="label label-success">CSP Level 2</span>
        <span class="label label-default" title="Chrome 40+ - January 2015"><i class="fa fa-chrome"></i> 40+</span>
        <span class="label label-default" title="Edge 15+ - January 2017"><i class="fa fa-edge"></i> 15+</span>
      </div>

      <h3><code>report-to</code></h3>
      <div class="pd">
        <p>Defines a <em>reporting group</em> name defined by a <code>Report-To</code> HTTP response header. See the <a href="https://w3c.github.io/reporting/">Reporting API</a> for more info.</p>
        <h5>Example report-to Directive</h5>
        <pre>report-to groupName;</pre>
        <span class="label label-success">CSP Level 3</span> 
        <span class="label label-default" title="Chrome 70+ - October 2018"><i class="fa fa-chrome"></i> 70+</span>
      </div>

      <h3><code>worker-src</code></h3>
      <div class="pd">
        <p>Restricts the URLs which may be loaded as a Worker, SharedWorker or ServiceWorker.</p>
        <h5>Example worker-src Policy</h5>
        <pre>worker-src 'none';</pre>
        <span class="label label-success">CSP Level 3</span> 
        <span class="label label-default" title="Chrome 59+ - June 2017"><i class="fa fa-chrome"></i> 59+</span>
        <span class="label label-default" title="Firefox 58+ - September 2017"><i class="fa fa-firefox"></i> 58+</span>
      </div>

      <h3><code>manifest-src</code></h3>
      <div class="pd">
        <p>Restricts the URLs that application manifests can be loaded.</p>
        <h5>Example manifest-src Policy</h5>
        <pre>manifest-src 'none';</pre>
        <span class="label label-success">CSP Level 3</span> 
        <span class="label label-default" title="Chrome Supported"><i class="fa fa-chrome"></i> Yes</span>
        <span class="label label-default" title="Firefox 40+ - 2015"><i class="fa fa-firefox"></i> 40+</span>
      </div>

      <h3><code>prefetch-src</code></h3>
      <div class="pd">
        <p>Defines valid sources for request prefetch and prerendering, for example via the <code>link</code> tag with <code>rel="prefetch"</code> or <code>rel="prerender"</code>:</p>
        <h5>Example prefetch-src Policy</h5>
        <pre>prefetch-src 'none'</pre>
        <span class="label label-success">CSP Level 3</span> 
      </div>

      <h3><code>navigate-to</code></h3>
      <div class="pd">
        <p>Restricts the URLs that the document may navigate to by any means. For example when a link is clicked, a form is submitted, or <code>window.location</code> is invoked. If <code>form-action</code> is present then this directive is ignored for form submissions. <a href="https://www.chromestatus.com/features/6457580339593216" rel="nofollow">Implementation Status</a></p>
        <h5>Example navigate-to Policy</h5>
        <pre>navigate-to example.com</pre>
        <span class="label label-success">CSP Level 3</span> 
      </div>



      <br>

      <h2 id="source_list">Source List Reference</h2>
      <p>All of the directives that end with <code>-src</code> support similar values known as a source list. Multiple source list values can be space separated with the exception of <code>'none'</code> which should be the only value.</p>
      <table class="table table-bordered table-responsive">
        <thead>
          <tr>
            <th>Source Value</th>
            <th>Example</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>*</code></td>
            <td><code>img-src *</code></td>
            <td>Wildcard, allows any URL except data: blob: filesystem: schemes.</td>
          </tr>
          <tr>
            <td><a href="/none/" title="CSP none"><code>'none'</code></a></td>
            <td><code>object-src 'none'</code></td>
            <td>Prevents loading resources from any source.</td>
          </tr>
          <tr>
            <td><a href="/self/" title="CSP self"><code>'self'</code></a></td>
            <td><code>script-src 'self'</code></td>
            <td>Allows loading resources from the same origin (same scheme, host and port).</td>
          </tr>
          <tr>
            <td><code>data:</code></td>
            <td><code>img-src 'self' data:</code></td>
            <td>Allows loading resources via the data scheme (eg Base64 encoded images).</td>
          </tr>
          <tr>
            <td><code><em><span class="hidden-xs">domain.</span>example.com</em></code></td>
            <td><code>img-src <span class="hidden-xs">domain.</span>example.com</code></td>
            <td>Allows loading resources from the specified domain name.</td>
          </tr>
          <tr>
            <td><code><em>*.example.com</em></code></td>
            <td><code>img-src *.example.com</code></td>
            <td>Allows loading resources from any subdomain under <code><em>example.com</em></code>.</td>
          </tr>
          <tr>
            <td><code><em>https://cdn.com</em></code></td>
            <td><code>img-src https://cdn.com</code></td>
            <td>Allows loading resources only over HTTPS matching the given domain.</td>
          </tr>
          <tr>
            <td><code>https:</code></td>
            <td><code>img-src https:</code></td>
            <td>Allows loading resources only over HTTPS on any domain.</td>
          </tr>
          <tr>
            <td><a href="/unsafe-inline/" title="CSP unsafe-inline"><code>'unsafe-inline'</code></a></td>
            <td><code>script-src 'unsafe-inline'</code></td>
            <td>Allows use of inline source elements such as style attribute, onclick, or script tag bodies (depends on the context of the source it is applied to) and <code>javascript:</code> URIs</td>
          </tr>
          <tr>
            <td><code>'unsafe-eval'</code></td>
            <td><code>script-src 'unsafe-eval'</code></td>
            <td>Allows unsafe dynamic code evaluation such as JavaScript <code>eval()</code></td>
          </tr>
          <tr>
            <td><a href="/hash/" title="CSP hash"><code>'sha256-'</code></a></td>
            <td><code>script-src 'sha256-xyz...'</code></td>
            <td>Allows an inline script or CSS to execute if its hash matches the specified hash in the header. Currently supports SHA256, SHA384 or SHA512.  <span class="label label-success">CSP Level 2</span> </td>
          </tr>
          <tr>
            <td><a href="/nonce/" title="Nonce Support in CSP"><code>'nonce-'</code></a></td>
            <td><code>script-src 'nonce-r@nd0m'</code></td>
            <td>Allows an inline script or CSS to execute if the script (eg: <code>&lt;script nonce="r@nd0m"&gt;</code>) tag contains a nonce attribute matching the nonce specifed in the CSP header. The nonce should be a secure random string, and should not be reused. <span class="label label-success">CSP Level 2</span> </td>
          </tr>
          <tr>
            <td><a href="/strict-dynamic/" title="CSP strict-dynamic"><code>'strict-dynamic'</code></a></td>
            <td><code>script-src 'strict-dynamic'</code></td>
            <td>Enables an allowed script to load additional scripts via non-"parser-inserted" script elements (for example <code>document.createElement('script');</code> is allowed).  <span class="label label-success">CSP Level 3</span> </td>
          </tr>
          <tr>
            <td><a href="/unsafe-hashes/" title="CSP unsafe-hashes"><code>'unsafe-hashes'</code></a></td>
            <td><code>script-src 'unsafe-hashes' 'sha256-abc...'</code></td>
            <td>Allows you to enable scripts in event handlers (eg <code>onclick</code>). Does not apply to <code>javascript:</code> or inline <code>&lt;script&gt;</code>  <span class="label label-success">CSP Level 3</span> </td>

          </tr>
        </tbody>
      </table>

      <h2>Content-Security-Policy Examples</h2>
      <p>Here a few common scenarios for content security policies:</p>
      <h4>Allow everything but only from the same origin</h4>
      <pre>default-src 'self';</pre>

      <h4>Only Allow Scripts from the same origin</h4>
      <pre>script-src 'self';</pre>

      <h4>Allow Google Analytics, Google AJAX CDN and Same Origin</h4>
      <pre>script-src 'self' www.google-analytics.com ajax.googleapis.com;</pre>

      <h4>Starter Policy</h4>
      <p>This policy allows images, scripts, AJAX, form actions, and CSS from the same origin, and does not allow any other resources to load (eg object, frame, media, etc). It is a good starting point for many sites.</p>
      <pre>default-src 'none'; script-src 'self'; connect-src 'self'; img-src 'self'; style-src 'self';base-uri 'self';form-action 'self'</pre>

      <hr>

      <h2 id="errors">Content-Security-Policy Error Messages</h2>
      <p>In Chrome when a Content Security Policy Script Violation happens you get a message like this one in the <em>Chrome Developer Tools</em>:</p>
      <pre>Refused to load the script '<em>script-uri</em>' because it violates the following Content Security Policy directive: "<em>your CSP directive</em>".</pre>
      <p>In Firefox you might see messages like this in the <em>Web Developer Tools</em>:</p>
      <pre>Content Security Policy: A violation occurred for a report-only CSP policy ("An attempt to execute inline scripts has been blocked"). The behavior was allowed, and a CSP report was sent.</pre>
      <p>In addition to a console message, a <code>securitypolicyviolation</code> event is fired on the window. See <a href="https://www.w3.org/TR/CSP2/#firing-securitypolicyviolationevent-events" rel="nofollow">https://www.w3.org/TR/CSP2/#firing-securitypolicyviolationevent-events</a>.

      <h2 id="server">Server Side Configuration</h2>

      <p>Any server side programming environment should allow you to send back a custom HTTP response header. You can also use your web server to send back the header.</p>
      <h3 id="apache">Apache Content-Security-Policy Header</h3>
      <p>Add the following to your <code>httpd.conf</code> in your <code>VirtualHost</code> or in an <code>.htaccess</code> file:</p>
      <pre>Header set Content-Security-Policy "default-src 'self';"</pre>
      <h3 id="nginx">Nginx Content-Security-Policy Header</h3>
      <p>In your <code>server {}</code> block add:</p>
      <pre>add_header Content-Security-Policy "default-src 'self';";</pre>
      <p>You can also append <code>always</code> to the end to ensure that nginx sends the header reguardless of response code.</p>
      <h3 id="iis">IIS Content-Security-Policy Header</h3>
      <p>You can use the HTTP Response Headers GUI in IIS Manager or add the following to your web.config:</p>
      <pre>&lt;system.webServer&gt;
  &lt;httpProtocol&gt;<strong>
    &lt;customHeaders&gt;
      &lt;add name="Content-Security-Policy" value="default-src 'self';" /&gt;
    &lt;/customHeaders&gt;</strong>
  &lt;/httpProtocol&gt;
&lt;/system.webServer&gt;</pre>

      

